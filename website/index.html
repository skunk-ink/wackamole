<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wack-A-Mole — README</title>
  <style>
    :root {
      --bg:#0f172a; --fg:#e5e7eb; --card:#111827;
      --muted:#94a3b8; --surface:#1f2937; --ring:#eab308;
    }
    @media (prefers-color-scheme: light) {
      :root { --bg:#f8fafc; --fg:#111827; --card:#ffffff; --muted:#6b7280; --surface:#f3f4f6; --ring:#facc15; }
    }

    * { box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      margin: 0; background: var(--bg); color: var(--fg);
      font: 16px/1.6 system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial;
    }
    header {
      position: sticky; top: 0; z-index: 10;
      background: var(--card); border-bottom: 1px solid var(--surface);
      padding: 0.9rem 1rem;
    }
    .wrap { max-width: 980px; margin: 0 auto; display: flex; gap: .75rem; align-items: center; }
    .brand { font-weight: 700; font-size: 1rem; }
    .tag { font-size: .85rem; color: var(--muted); }
    main { max-width: 980px; margin: 1.25rem auto; padding: 0 1rem; }
    .card { background: var(--card); border: 1px solid var(--surface); border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,.05); }
    .pad { padding: 1.4rem; }

    h1,h2,h3 { line-height: 1.25; }
    h2,h3 { margin-top: 1.6rem; }
    pre, code { background: var(--surface); }
    code { padding: .15rem .35rem; border-radius: .35rem; }
    pre { padding: 1rem; border-radius: .6rem; overflow: auto; }
    a { color: #60a5fa; text-decoration: none; }
    a:hover { text-decoration: underline; }
    .muted { color: var(--muted); }
    .hint { font-size: .9rem; margin-top: .25rem; }
    .highlight {
      background: #fffbeb; color: inherit;
      border-left: 4px solid var(--ring);
      padding: .75rem; border-radius: .5rem; margin: .75rem 0;
    }

    /* ---------- TOC / nested list fixes (apply to any README lists) ---------- */
    #readme ul {                 /* base list indentation */
      margin: .25rem 0 .25rem 1.25rem;
      padding-left: 1.25rem;
    }
    #readme ol {
      margin: .25rem 0 .25rem 1.25rem;
      padding-left: 1.25rem;
    }
    #readme ul ul,
    #readme ol ul,
    #readme ul ol,
    #readme ol ol {              /* deeper levels */
      margin-left: 1.25rem;
      padding-left: 1.25rem;
    }

    /* bullet styles by depth for clarity */
    #readme ul { list-style: disc; }
    #readme ul ul { list-style: circle; }
    #readme ul ul ul { list-style: square; }

    /* if Markdown's toc extension is used, keep it tidy too */
    .toc { margin: 1.25rem 0; }
    .toc ul { margin: .25rem 0 .25rem 1.25rem; padding-left: 1.25rem; }
    .toc li { margin: .2rem 0; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brand">Wack-A-Mole</div>
      <div class="tag">Decentralized Site Publisher & Gateway</div>
      <div style="margin-left:auto" class="muted hint">This page is generated from README.md</div>
    </div>
  </header>
  <main>
    <div class="card pad" id="readme">
      <h1 id="wack-a-mole-site-decentralization">Wack-A-Mole Site Decentralization</h1>
<p><strong>Decentralized Static-Site Publisher &amp; Gateway for the Sia Network</strong></p>
<p>Wack-A-Mole is a publishing framework that lets you upload any static website to the <strong>Sia Network</strong> through a remote <strong>Indexd</strong> node and serve it directly from decentralized storage — no central server required.</p>
<p>It includes:</p>
<ul>
<li><strong><code>publish.py</code></strong> — Uploads your static site (zipped) to Sia via Indexd.  </li>
<li><strong><code>gateway.py</code></strong> — Runs a stateless HTTP gateway that serves your site straight from its decentralized zip.</li>
</ul>
<hr>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#architecture-overview">Architecture Overview</a></li>
<li><a href="#setup">Setup</a></li>
<li><a href="#1-clone-repositories">1. Clone Repositories</a></li>
<li><a href="#2-build-the-ffi-bridge">2. Build the FFI Bridge</a></li>
<li><a href="#3-environment-setup">3. Environment Setup</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#publisher-publishpy">Publisher (<code>publish.py</code>)</a></li>
<li><a href="#gateway-gatewaypy">Gateway (<code>gatewaypy</code>)</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#health-checks">Health Checks</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#security-notes">Security Notes</a></li>
<li><a href="#version-history">Version History</a></li>
<li><a href="#license">License</a></li>
</ul>
<hr>
<h2 id="architecture-overview">Architecture Overview</h2>
<div class="codehilite"><pre><span></span><code><span class="k">[Local Site] → publish.py → [Indexd Node] → [Sia Network]</span>
<span class="w">                                  </span><span class="na">↓</span>
<span class="w">                         </span><span class="na">gateway.py (FastAPI)</span>
<span class="w">                                  </span><span class="na">↓</span>
<span class="w">                             </span><span class="k">[Browser]</span>
</code></pre></div>

<ul>
<li><strong>Indexd Node</strong> — Bridges your data into the Sia decentralized storage network.  </li>
<li><strong>Publisher</strong> — Packages and uploads your local website as a shareable object.  </li>
<li><strong>Gateway</strong> — Fetches and serves sites directly from their decentralized zip share.  </li>
<li><strong>End-User</strong> — Views the site via any gateway node, using the shared capability URL.</li>
</ul>
<hr>
<h2 id="setup">Setup</h2>
<h3 id="1-clone-repositories">1. Clone Repositories</h3>
<div class="codehilite"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/skunk-ink/wackamole
<span class="nb">cd</span><span class="w"> </span>wackamole
</code></pre></div>

<p>Clone and build the Sia SDK:</p>
<div class="codehilite"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/siafoundation/sia-sdk-rs
<span class="nb">cd</span><span class="w"> </span>sia-sdk-rs
</code></pre></div>

<h3 id="2-build-the-ffi-bridge">2. Build the FFI Bridge</h3>
<p>You’ll need to compile the <strong><code>indexd_ffi</code></strong> dynamic library used by both scripts.</p>
<h4 id="linux">Linux</h4>
<div class="codehilite"><pre><span></span><code>cargo<span class="w"> </span>build<span class="w"> </span>--release<span class="w"> </span>-p<span class="w"> </span>indexd_ffi
cargo<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span>indexd_ffi<span class="w"> </span>--bin<span class="w"> </span>uniffi-bindgen<span class="w"> </span>generate<span class="w">   </span>--library<span class="w"> </span>target/release/libindexd_ffi.so<span class="w">   </span>--language<span class="w"> </span>python<span class="w"> </span>--out-dir<span class="w"> </span>../
mv<span class="w"> </span>target/release/libindexd_ffi.so<span class="w"> </span>../
</code></pre></div>

<h4 id="macos">macOS</h4>
<div class="codehilite"><pre><span></span><code>cargo<span class="w"> </span>build<span class="w"> </span>--release<span class="w"> </span>-p<span class="w"> </span>indexd_ffi
cargo<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span>indexd_ffi<span class="w"> </span>--bin<span class="w"> </span>uniffi-bindgen<span class="w"> </span>generate<span class="w">   </span>--library<span class="w"> </span>target/release/libindexd_ffi.dylib<span class="w">   </span>--language<span class="w"> </span>python<span class="w"> </span>--out-dir<span class="w"> </span>../
mv<span class="w"> </span>target/release/libindexd_ffi.dylib<span class="w"> </span>../
</code></pre></div>

<h4 id="windows-powershell">Windows (PowerShell)</h4>
<div class="codehilite"><pre><span></span><code><span class="n">cargo</span> <span class="n">build</span> <span class="p">-</span><span class="n">-release</span> <span class="n">-p</span> <span class="n">indexd_ffi</span>
<span class="n">cargo</span> <span class="n">run</span> <span class="n">-p</span> <span class="n">indexd_ffi</span> <span class="p">-</span><span class="n">-bin</span> <span class="n">uniffi-bindgen</span> <span class="p">--</span> <span class="n">generate</span> <span class="p">-</span><span class="n">-library</span> <span class="p">.\</span><span class="n">target</span><span class="p">\</span><span class="n">release</span><span class="p">\</span><span class="n">indexd_ffi</span><span class="p">.</span><span class="n">dll</span> <span class="p">-</span><span class="n">-language</span> <span class="n">python</span> <span class="p">-</span><span class="n">-out-dir</span> <span class="p">../</span>
<span class="nb">mv </span><span class="n">target</span><span class="p">\</span><span class="n">release</span><span class="p">\</span><span class="n">indexd_ffi</span><span class="p">.</span><span class="n">dll</span> <span class="p">../</span>
</code></pre></div>

<p>Return to the main folder:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../wackamole
</code></pre></div>

<h3 id="3-environment-setup">3. Environment Setup</h3>
<p>Create a <code>.env</code> file in the project root:</p>
<div class="codehilite"><pre><span></span><code><span class="na">APP_ID_HEX</span><span class="o">=</span><span class="s">&lt;your app id hex&gt;</span>
<span class="na">MNEMONIC</span><span class="o">=</span><span class="s">&lt;your seed phrase&gt;</span>
<span class="na">INDEXD_URL</span><span class="o">=</span><span class="s">https://indexd.example.com</span>
<span class="na">APP_NAME</span><span class="o">=</span><span class="s">&quot;My Static Site&quot;</span>
<span class="na">APP_DESC</span><span class="o">=</span><span class="s">&quot;Publishes static sites to Sia via Indexd&quot;</span>
<span class="na">SERVICE_URL</span><span class="o">=</span><span class="s">&quot;https://example.com&quot;</span>
<span class="na">LOGO_URL</span><span class="o">=</span><span class="s">&quot;https://example.com/logo.png&quot;</span>
<span class="na">CALLBACK_URL</span><span class="o">=</span><span class="s">&quot;https://example.com/auth/callback&quot;</span>
</code></pre></div>

<hr>
<h2 id="usage">Usage</h2>
<h3 id="publisher-publishpy">Publisher (<code>publish.py</code>)</h3>
<p>Uploads your site to the Sia network through an Indexd node.</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--indexd</code></td>
<td>Remote Indexd URL</td>
<td><code>$INDEXD_URL</code></td>
</tr>
<tr>
<td><code>--site</code></td>
<td>Path to built site directory</td>
<td><code>website/</code></td>
</tr>
<tr>
<td><code>--out</code></td>
<td>Manifest output path</td>
<td><code>manifest.json</code></td>
</tr>
<tr>
<td><code>--app-name</code>, <code>--app-desc</code>, <code>--service-url</code>, <code>--logo-url</code>, <code>--callback-url</code></td>
<td>Optional metadata</td>
<td>from <code>.env</code></td>
</tr>
<tr>
<td><code>--share-days</code></td>
<td>How long the share link is valid</td>
<td><code>365</code></td>
</tr>
<tr>
<td><code>--data</code>, <code>--parity</code></td>
<td>Manual erasure coding overrides</td>
<td>smart defaults</td>
</tr>
<tr>
<td><code>--inflight</code></td>
<td>Parallel shard uploads</td>
<td><code>6</code></td>
</tr>
<tr>
<td><code>--chunk-mib</code></td>
<td>Upload chunk size</td>
<td><code>1</code></td>
</tr>
</tbody>
</table>
<h4 id="example">Example</h4>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>publish.py<span class="w"> </span>--indexd<span class="w"> </span>https://indexd.skunk.ink
</code></pre></div>

<p>Output:</p>
<div class="codehilite"><pre><span></span><code>Created zip: /tmp/site-1762469129.zip (208.0 B)
Uploading to Sia via Indexd...
✅ Upload complete.

Share URL (give this to a gateway):
https://indexd.skunk.ink/objects/&lt;hash&gt;/shared?...#encryption_key=...
Wrote manifest to: manifest.json
</code></pre></div>

<hr>
<h3 id="gateway-gatewaypy">Gateway (<code>gateway.py</code>)</h3>
<p>Runs a FastAPI web server that fetches and serves your site directly from its shared zip.</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--share</code></td>
<td>Share URL from the publisher</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>--indexd</code></td>
<td>Base URL (auto-detected if omitted)</td>
<td>—</td>
</tr>
<tr>
<td><code>--env</code></td>
<td>Path to <code>.env</code> file</td>
<td><code>.env</code></td>
</tr>
<tr>
<td><code>--host</code></td>
<td>Bind address</td>
<td><code>127.0.0.1</code></td>
</tr>
<tr>
<td><code>--port</code></td>
<td>Port to listen on</td>
<td><code>8787</code></td>
</tr>
</tbody>
</table>
<h4 id="example_1">Example</h4>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>gateway.py<span class="w"> </span>--share<span class="w"> </span><span class="s2">&quot;https://indexd.skunk.ink/objects/&lt;hash&gt;/shared?...#encryption_key=...&quot;</span>
</code></pre></div>

<p>Output:</p>
<div class="codehilite"><pre><span></span><code>Loaded ZIP with 42 entries.
Try: http://127.0.0.1:8787/
Uvicorn running on http://127.0.0.1:8787 (Press CTRL+C to quit)
</code></pre></div>

<hr>
<h3 id="build-example-site-examplesbuild_html_readmepy">Build example site (examples/build_html_readme.py)</h3>
<p><strong>Requirements:</strong></p>
<div class="codehilite"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>markdown<span class="w"> </span>pygments
</code></pre></div>

<hr>
<h2 id="configuration">Configuration</h2>
<h3 id="environment-variables">Environment Variables</h3>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>APP_ID_HEX</code></td>
<td>Application identity (hex)</td>
</tr>
<tr>
<td><code>MNEMONIC</code></td>
<td>App seed phrase</td>
</tr>
<tr>
<td><code>INDEXD_URL</code></td>
<td>Default remote Indexd node</td>
</tr>
<tr>
<td><code>APP_NAME</code> / <code>APP_DESC</code></td>
<td>Metadata for shared objects</td>
</tr>
<tr>
<td><code>SERVICE_URL</code>, <code>LOGO_URL</code>, <code>CALLBACK_URL</code></td>
<td>Optional URLs used in Indexd app registration</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="health-checks">Health Checks</h2>
<p>Each running gateway exposes:</p>
<div class="codehilite"><pre><span></span><code>GET /__health
</code></pre></div>

<p>Returns <code>200 OK</code> if the site zip is loaded and accessible.</p>
<hr>
<h2 id="security-notes">Security Notes</h2>
<ul>
<li><strong>Keep your mnemonic private</strong> — it’s your signing seed.  </li>
<li>Share URLs contain <strong>capability tokens</strong>; treat them as sensitive.  </li>
<li>Use short <code>--share-days</code> for temporary content.  </li>
<li>Run gateways in isolated environments when possible.</li>
</ul>
<hr>
<h2 id="license">License</h2>
<p>See <a href="LICENSE">LICENSE</a>.</p>
    </div>
  </main>
</body>
</html>
